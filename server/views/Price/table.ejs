<!DOCTYPE html>
<html>

<%- include('../templates/head', {datahead: {titulo: 'Lista de Precios' , css: '/css/Price/table.css' }}) %>

    <body>
        <div class="table"> 
            <div class="container-btns">
                <button class='btn'><a href="/api/menu/prices/search"> <h4>Volver</h4></a></button>
                <button class='btn'><a href="/api/menu/prices/search"><h4>Modificación Masiva</h4></a></button>
            </div>           
            <div class="container-table">                            
                <table id='myTable'>
                    <thead>
                        <tr>
                            <th>PLU</th><th>NOMBRE</th><th>PRECIO</th>                                                                                           
                        </tr>
                    </thead>
                    <tbody>
                        <% if (data) { %>
                            <% for (var i = 0; i < data.product.pid.length;  i++ ) { %>                            
                                <tr>
                                    <form method="POST" id="newprice" action="/api/menu/prices/updateProductPrice">                                    
                                        <td><input class="inputDisable" type="text" name="id" value="<%= data.product.pid[i] %>" readonly></td>
                                        <td><input class="inputDisable" type="text" name="name" value="<%= data.product.pname[i] %>" readonly title="<%= data.product.pname[i] %>"></td>
                                        <td><input class="inputPrice" type="number" name="newPrice" value="<%= data.product.pprice[i] %>" onclick="this.value=''" onchange="this.form.submit()"/></td>                                    
                                    </form>                                
                                </tr>
                            <% } %>                            
                        <% } else { %>
                                <tr>
                                    <td colspan="3">No_hay_registros</td>                                            
                                </tr>
                        <% } %>
                    </tbody>
                </table>                                                    
            </div>
            <form id="input-page-form" class="form-pagination" action="/api/menu/prices/pagination" method="post">
                <div class="page-controll">
                    <h4>Mostrando página&nbsp</h4>
                    <input type="number" min="1" max="<%=data.page.totalPaginas%>" id="inputPage" placeholder="<%=data.page.pagActual%>" name="inputPage" value="<%=data.page.pagActual%>" onchange="submitForm('input-page-form')"/>
                    <h4> de <%=data.page.totalPaginas%></h4>
                </div>
                <div class="page-controll">
                    <input class="btn-pagination" type="button" id="first" onclick="setPage(event)" value="<%=__('| <')%>" >
                    <input class="btn-pagination" type="button" id="previous" onclick="setPage(event)" value="<%=__('<<')%>" >
                    <input class="btn-pagination" type="button" id="next" onclick="setPage(event)" value="<%=__('>>')%>" >
                    <input class="btn-pagination" type="button" id="last" onclick="setPage(event)" value="<%=__('> |')%>" >
                </div>
                <div class="page-controll">
                    <h4><%=data.page.forMinimo%> a <%=data.page.forMaximo%> registros de <%=data.page.regTotal%></h4>
                </div>
            </form>
        </div>        
        <script>

            function setPage(e) {
                //console.log('Opcion: '+e.target.id);
                var inputPage = parseInt(document.getElementById('inputPage').value);
                
                if (e.target.id == 'first'){
                    document.getElementById('inputPage').value = 1;
                    submitForm('input-page-form');
                } 
                if (e.target.id == 'previous'){
                    if (inputPage == 1){
                        alert('Ya se encuentra en la primer página!');
                    } else {
                        document.getElementById('inputPage').value = inputPage -1;
                        submitForm('input-page-form');
                    }                    
                }
                if (e.target.id == 'next'){
                    if (inputPage == <%=data.page.totalPaginas%>){
                        alert('Ya se encuentra en la última página!');
                    } else {
                        document.getElementById('inputPage').value = inputPage +1;
                        submitForm('input-page-form');
                    }                    
                }
                if (e.target.id == 'last'){
                    document.getElementById('inputPage').value = <%=data.page.totalPaginas%>;
                    submitForm('input-page-form');
                }                 
            }


            function submitForm(formId) {
                var oForm = document.getElementById(formId);
                if (oForm) {
                    oForm.submit(); 
                }
            }

        </script>        
    </body>

</html>